@using Business.ViewModels.Basket
@model BasketIndexVM

<!-- Shopping Bag -->
<div class="basket-container" style="max-height: calc(100vh - 200px); overflow-y: auto; margin: 20px 0;">
    <div class="basket-items">
        @foreach (var item in Model.BasketProducts)
        {
            <div class="basket-wrapper" style="display: flex; width: 100%; padding: 10px; box-sizing: border-box;">
                <div class="basket-item-image" style="flex: 0 0 auto; margin-right: 20px;">
                    <img src="@item.Product.ImagePath" alt="@item.Product.Title" style="max-width: 150px;">
                </div>
                <div class="basket-item-info" style="flex: 1; display: flex; flex-direction: column;">
                    <div class="basket-item-title">@item.Product.Title</div>
                    <div class="basket-item-price">$@((item.Product.Price * item.Count).ToString("0.00"))</div>
                    <div class="basket-item-category">
                        Category: @item.Product.ProductCategories?.FirstOrDefault()?.Category?.Name
                    </div>
                    <div class="basket-item-color">
                        Selected Color: @item.Color?.Name
                    </div>
                    <div class="basket-item-size">
                        Selected Size: @item.Size?.Name
                    </div>
                    <div class="basket-quantity">
                        Quantity:
                        <input type="number"
                               class="quantity-input"
                               value="@item.Count"
                               min="1"
                               max="@item.Product.StockCount"
                               data-product-id="@item.ProductId"
                               data-color="@item.Color?.Name"
                               data-size="@item.Size?.Name"
                               style="width: 60px;">
                    </div>
                    <button class="basket-remove-btn">Remove</button>
                </div>
            </div>
        }
    </div>

    <div class="basket-actions">
        @{
            var totalPrice = Model.BasketProducts.Sum(item => item.Product.Price * item.Count);
        }
        <div class="total-price">Total Price: <span>$@totalPrice.ToString("0.00")</span></div>
        <button class="checkout-btn">Checkout</button>
        <a asp-controller="Wishlist" asp-action="Index">
            <button class="favorites-btn">Go to Favorites</button>
        </a>
    </div>
</div>
<!-- Shopping Bag End -->