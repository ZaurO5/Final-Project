@using Core.Entities
@model Product

<!-- Product Details -->
<section class="details-page">
    <div class="container">
        <div class="product-card">
            <div class="product-image">
                <img src="@Model.ImagePath" alt="@Model.Title">
            </div>
            <div class="product-info">
                <h2 class="product-name">@Model.Title</h2>
                <h3 class="product-price">@Model.Price.ToString("0.##")$</h3>

                @if (Model.ProductCategories?.Any() == true)
                {
                    <h2 class="product-category">
                        Category: @string.Join(", ", Model.ProductCategories.Select(pc => pc.Category?.Name))
                    </h2>
                }

                @if (!string.IsNullOrEmpty(Model.Description))
                {
                    <div class="product-description">
                        <p>@Model.Description</p>
                    </div>
                }

                <form asp-controller="Basket" asp-action="AddProduct" method="post">
                    <div class="product-options">
                        <label>Select Color:</label>
                        <div class="color-options">
                            @foreach (var color in Model.ProductColors?.Select(pc => pc.Color) ?? Enumerable.Empty<Color>())
                            {
                                <label>
                                    <input type="radio" name="colorId" value="@color.Id" required>
                                    <span class="color"
                                          style="background-color: @color.HexCode; width: 40px; height: 40px; border-radius: 50%; margin: 5px;"
                                          title="@color.Name">
                                    </span>
                                </label>
                            }
                        </div>
                    </div>

                    <div class="product-options">
                        <label>Select Size:</label>
                        <div class="size-options">
                            @foreach (var size in Model.ProductSizes?.Select(ps => ps.Size) ?? Enumerable.Empty<Size>())
                            {
                                <label>
                                    <input type="radio" name="sizeId" value="@size.Id" required>
                                    <span class="size"
                                          style="padding: 8px 15px; margin: 5px; border-radius: 4px;"
                                          title="@size.Name">
                                        @size.Name
                                    </span>
                                </label>
                            }
                        </div>
                    </div>

                    <div class="quantity">
                        <label for="quantity">Quantity:</label>
                        <input type="number"
                               id="quantity"
                               name="quantity"
                               min="1"
                               max="@Model.StockCount"
                               value="1"
                               class="quantity-input"
                               required>
                    </div>

                    <input type="hidden" name="productId" value="@Model.Id" />

                    <div class="actions">
                        <button type="submit"
                                class="btn add-to-basket @(Model.StockCount == 0 ? "disabled" : "")"
                        @(Model.StockCount == 0 ? "disabled" : "")>
                            @(Model.StockCount == 0 ? "Out of Stock" : "Add to Shopping Bag")
                        </button>
                    </div>
                </form>

                <form asp-controller="Favorites" asp-action="AddToFavorites" method="post">
                    <input type="hidden" name="productId" value="@Model.Id" />
                    <div class="actions">
                        <button type="submit" class="btn add-to-favorites">Add to Favorites</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</section>


<!-- Инициализация данных для JS -->
<script>
    window.productData = {
        stockCount: @Model.StockCount,
        productId: @Model.Id
    };
</script>